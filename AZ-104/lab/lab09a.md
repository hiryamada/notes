# ラボ9a

想定時間: 30分

App ServiceのWebアプリを作成する方法を学びます。

## ラボの重要ポイント

- タスク1
  - App Serviceのアプリ（Webアプリ、PHP）を作成します
  - アプリと同時に、デフォルトの設定の「プラン」も作成します
- タスク2
  - このアプリには「運用（Production）」というデプロイスロットが1つあります
  - 新しいデプロイスロット「ステージング（staging）」を追加します。
- タスク3
  - 「ステージング」デプロイスロットに対して操作を行います
    - スロットへのデプロイ方法として「ローカルGit」を選択します
      - スロット側にデプロイ用のリポジトリが作られます
      - 開発環境から、「git push」で、スロットへ最新コードをプッシュすることでデプロイできます
- タスク4
  - ここではCloud Shellを開発環境代わりに使用します。
  - サンプルのPHPコード（hello worldを表示）をGitHubから取得します
  - 「git push」でPHPコードをステージングスロットにプッシュします
- タスク5
  - ステージングスロットと運用スロットのコンテンツを「スワップ」します
  - 「運用」スロットにアクセスして、PHPのコード（hello world）が表示されることを確認します
- タスク6   
  - プランのCPU使用率に応じて、プランのインスタンス（プランを稼働させているVM）の数を増加させるように、プランの自動スケーリングの設定を行います
  - Cloud Shellからアプリに繰り返しアクセスを行い、プランがスケールアウトすることを確認します

## 補足事項

タスク1の3
名前：任意のものですがユニークでなければならないです。

タスク2の2
注の部分　PRODUCTIONというラベル→運用というラベル

タスク2の3
名前：staging（URLなので英字のほうが良いかも。カナでも動きます）

タスク3の2
「継続的デプロイ (CI/CD)」 セクションで 「ローカル Git」 を選択し、「続行」 をクリックします。
→「継続的デプロイ (CI/CD)」 セクションで 「設定に移動する」をクリックして、
ソースで「ローカル Git」 を選択し、「保存」 をクリックします。

タスク3の3は飛ばしてください。

タスク3の5
「デプロイ資格情報」 ツールバー アイコンをクリックして 「デプロイ資格情報」 ウィンドウを表示します。
→「ローカルGitまたはFTPSの資格情報」ツールバー アイコンをクリックして 「ユーザスコープ」に7の情報を入力して「保存」します。

タスク5の2
「デプロイ」 セクション→「デプロイメント」セクション
「ツール バー アイコンのスワップ」 →「スワップ」

タスク6　最初の注意はラボ8で実施済みだと思うので、念のため確認だけして進んでください。

タスク6の3
「+ ルールの追加」→「+ 規則を追加する」

タスク6の13
インスタンス数が 2 つに増えた場合は、Cloud Shell ウィンドウを再び開き、Ctrl + C キーを押してスクリプトを終了します。
→確認の仕方としてはインスタンスIDというものが2つになります。