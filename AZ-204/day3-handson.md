# ハンズオン: Azure ADへのアプリの登録

Azure AD＞アプリの登録＞新規登録
- 名前: test1
- サポートされているアカウントの種類: デフォルト（この組織ディレクトリのみに含まれるアカウント）
- リダイレクトURI: （変更しない）
- 「登録」をクリック
- 「アプリケーション（クライアント）ID」と、「ディレクトリ（テナント）ID」に、[グローバル一意識別子(GUID)](https://ja.wikipedia.org/wiki/GUID)（「fd535a1c-7dd5-49c8-ae98-3d205ba9086c」のような文字列）が割り当てされたことを確認してください。
  - これらの値は、実際に開発するアプリケーション側の設定値として使用されます。
- 画面上部「エンドポイント」をクリックして、OAuth 2.0などのエンドポイントが作成されていることを確認してください。
  - アプリケーションは、このエンドポイントに向かって通信します。
  - エンドポイントのURLには、「ディレクトリ（テナント）ID」が含まれていることが確認できます
  - つまりエンドポイントは、登録した各アプリではなく、テナントに対して作られています
  - 「エンドポイント」画面の右上の「✕」をクリックして閉じます。
- 画面左「クイックスタート」をクリックして、「Webアプリケーション」の「開始」、「ASP.NET」などのように選択し、画面に表示される内容を確認してください
  - 「この変更を行う」で、各アプリを動作させるために必要な設定の変更（適切な「リダイレクトURI」の設定など）が行えることを確認します
  - 「コードサンプルをダウンロードする」から、コードサンプルを入手できることを確認します
- 画面左「統合アシスタント」をクリックして、「お客様がビルドしているアプリケーションの種類」として「Webアプリ」を選び、「アプリの登録を評価する」をクリックします
  - 選択したアプリを登録する際に必要な設定がされているかどうかがチェックされます
  - 実際の運用前は、この機能を使って、「アプリの登録」が適切にされているかどうかをチェックできます。
- 画面左「ブランド」で、登録時に指定した名前が変更できることを確認します
- 画面左「認証」で、登録時に指定した「サポートされているアカウントの種類」を「マルチテナント」に変更できることを確認します。
- 画面左「証明書とシークレット」で、「＋新しいクライアントシークレット」をクリックし、適当な説明を入力して「追加」をクリックします
  - アプリの「クライアントシークレット」を追加できます。
  - このシークレットIDと値は、「[機密クライアント アプリケーション](https://docs.microsoft.com/ja-jp/azure/active-directory/develop/msal-client-applications)」で使用されます。
- 画面左「APIのアクセス許可」で、「＋アクセス許可の追加」をクリックし、アプリに割り当てできるAPIを確認します。
  - 「Microsoft Graph」をクリックします
  - 「委任されたアクセス許可」をクリックします。
  - 「アクセス許可を選択する」で、「send」で検索します。
  - 「Mail」を展開し、「Mail.Send」というアクセス許可をチェックし、「アクセス許可の追加」をクリックします。
  - また、Azure Cosmos DB、Azure Storage、OneNote、SharePointなど、さまざまなAPIのアクセス許可を追加できます。
    - ここで追加した「アクセス許可」は、実際には、**アプリを使用するユーザーが「同意」した場合に**、許可されます。
