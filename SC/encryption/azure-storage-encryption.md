# Azure Storage 暗号化

※サーバー側暗号化 (SSE)とも

https://docs.microsoft.com/ja-jp/azure/storage/common/storage-service-encryption

Azure Storage（ストレージ アカウント）において、データがクラウドに永続化されるときに自動的・透過的に暗号化（復号）される。

■サービスレベルの暗号化

- すべてのストレージ アカウントで有効
- サーバー側暗号化 (SSE) を使用して、データがクラウドに永続化されるときに自動的に暗号化
- 256 ビット AES 暗号化を使用
- 無効にすることはできない
- コードまたはアプリケーションを変更する必要はない
- 追加コストはない
- 使用されるキー
  - Microsoft のマネージド キー	
    - 対象: すべて
    - キー管理: Microsoft キー ストア
  - カスタマー マネージド キー
    - 対象: BLOBとFilesのみ
    - キー管理: 「Azure Key Vault」 または 「Azure Key Vault Managed HSM」に格納する必要がある
  - カスタマー指定のキー
    - 対象: BLOBのみ
    - キー管理: 客様側の独自のキーストアで管理

■インフラストラクチャレベルの暗号化

- インフラストラクチャ レベルで 256 ビットの AES 暗号化を有効にすることもできる
- 有効な場合、ストレージ アカウントのデータは、2 つの異なる暗号化アルゴリズムと 2 つの異なるキーを使用して、2 回暗号化される
  - サービス レベルで 1 回
  - インフラストラクチャ レベルで 1 回
- キー管理:
  - Microsoft マネージド キー
  - 常に別のキーが使用される
- 有効化方法
  - ストレージアカウント作成＞詳細設定＞インフラストラクチャ暗号化を有効にする 
    - デフォルトではチェックは付いていない
  - ストレージアカウントの**作成時**にインフラストラクチャ暗号化を使用するようにストレージ アカウントを構成する**必要がある**
  - ストレージ アカウントの**作成後**にインフラストラクチャ暗号化を有効または無効にすることは**できない**
  - 汎用v2のみ
