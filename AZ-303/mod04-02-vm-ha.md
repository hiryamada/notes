# 可用性についてのインフォグラフィック

https://azure.microsoft.com/mediahandler/files/resourcefiles/infographic-reliability-with-microsoft-azure/InfographicRC2.pdf

VMの可用性の違いについて説明されている。

- 単一VM: SLA: 99.9%
- 可用性セット,2台以上のVM: SLA: 99.95%
- 可用性ゾーン,2台以上のVM: SLA: 99.99% 

# 可用性セット

https://docs.microsoft.com/ja-jp/azure/virtual-machines/availability-set-overview

- 1つのデータセンター内の論理的なグループ。
- 同じ「役割」の複数のVMを運用する際に、可用性セットに入れることで、可用性を向上させることができる。
- 1つの「可用性セット」は「障害ドメイン」と「更新ドメイン」で構成される。
  - 「障害ドメイン」: 電源やネットワークスイッチを共有する範囲。
  - 「更新ドメイン」: 基盤となるプラットフォームの更新による再起動が行われる範囲。
- 可用性セットは、可用性ゾーンが使えないリージョンでも利用できる（西日本など）

使い方
- 「可用性セット」というリソースを作成
- 「可用性セット」内にVMをデプロイする

# 可用性ゾーン

https://docs.microsoft.com/ja-jp/azure/availability-zones/az-overview?context=/azure/virtual-machines/context/context#availability-zones

■可用性ゾーンに対応したリージョン

- リージョンによっては可用性ゾーンに対応している。
  - 東日本リージョンなど
  - 対応しているリージョンでは、少なくとも3つのゾーンが利用できる
    - ゾーン1
    - ゾーン2
    - ゾーン3
    - ※「少なくとも3つ」とあるが、実際には、4つ以上のゾーンを持ったリージョンは今の所存在しない。
- ゾーン
  - 1つ以上のデータセンターで構成されている。
  - 電源・冷却・ネットワークが独立して備わっている。
    - あるゾーンの電源障害があったとしても、別のゾーンはその影響をうけない。

■可用性ゾーンに対応するリージョンの一覧

https://docs.microsoft.com/ja-jp/azure/availability-zones/az-region#azure-regions-with-availability-zones

■可用性ゾーンにおける障害ドメインと更新ドメイン

- リージョン内の可用性ゾーンは、障害ドメインと更新ドメインを組み合わせたものとなる。
- 例
  - Azure リージョンの 3 つのゾーンに 3 つ以上の VM を作成する
  - VM は 3 つの障害ドメインと 3 つの更新ドメインに分散される。
  - Azure プラットフォームによって更新ドメイン全体でこの分散が認識され、異なるゾーンにある VM が同時に更新されるスケジュールにならないことが保証される。

■可用性ゾーンの利用方法

- VMは、可用性ゾーンを指定して配置することができる。
- ロードバランサーやVPNゲートウェイは「ゾーン冗長」をサポートしており、1つのリソースを、複数のゾーンにまたがる形で配置できる。

※可用性ゾーンに対応しているリージョンでも、特に可用性ゾーンを指定せずに、リージョンに対してVM等を配置することは可能。
